
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://durandtibo.github.io/sonnix/main/refs/utils/">
      
      
        <link rel="prev" href="../functional/">
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>sonnix.utils - sonnix</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sonnixutils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="sonnix" class="md-header__button md-logo" aria-label="sonnix" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            sonnix
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              sonnix.utils
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/durandtibo/sonnix" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    durandtibo/sonnix
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../get_started/" class="md-tabs__link">
        
  
  
    
  
  Get Started

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../root/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/durandtibo/sonnix" class="md-tabs__link">
        
  
  
    
  
  GitHub

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="sonnix" class="md-nav__button md-logo" aria-label="sonnix" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    sonnix
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/durandtibo/sonnix" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    durandtibo/sonnix
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../get_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Get Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sonnix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    sonnix.functional
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    sonnix.utils
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    sonnix.utils
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.device" class="md-nav__link">
    <span class="md-ellipsis">
      
        device
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="device">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.device.get_module_device" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_module_device
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.device.get_module_devices" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_module_devices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.device.is_module_on_device" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_module_on_device
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.imports" class="md-nav__link">
    <span class="md-ellipsis">
      
        imports
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.check_objectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_objectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.is_objectory_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_objectory_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.objectory_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        objectory_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.raise_error_objectory_missing" class="md-nav__link">
    <span class="md-ellipsis">
      
        raise_error_objectory_missing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.iterator" class="md-nav__link">
    <span class="md-ellipsis">
      
        iterator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iterator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.iterator.get_named_modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_named_modules
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        loss
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.loss.is_loss_decreasing" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_loss_decreasing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.loss.is_loss_decreasing_with_adam" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_loss_decreasing_with_adam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.loss.is_loss_decreasing_with_sgd" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_loss_decreasing_with_sgd
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        mode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.mode.module_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        module_mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.mode.top_module_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        top_module_mode
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.params" class="md-nav__link">
    <span class="md-ellipsis">
      
        params
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.freeze_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        freeze_module
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.has_learnable_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        has_learnable_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.has_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        has_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.num_learnable_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_learnable_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.unfreeze_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        unfreeze_module
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.random" class="md-nav__link">
    <span class="md-ellipsis">
      
        random
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="random">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.random.get_random_seed" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_random_seed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.random.get_torch_generator" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_torch_generator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.random.setup_torch_generator" class="md-nav__link">
    <span class="md-ellipsis">
      
        setup_torch_generator
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.state_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        state_dict
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="state_dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.state_dict.find_module_state_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_module_state_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.state_dict.load_state_dict_to_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_state_dict_to_module
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/durandtibo/sonnix" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.device" class="md-nav__link">
    <span class="md-ellipsis">
      
        device
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="device">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.device.get_module_device" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_module_device
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.device.get_module_devices" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_module_devices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.device.is_module_on_device" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_module_on_device
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.imports" class="md-nav__link">
    <span class="md-ellipsis">
      
        imports
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="imports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.check_objectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_objectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.is_objectory_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_objectory_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.objectory_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        objectory_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.imports.raise_error_objectory_missing" class="md-nav__link">
    <span class="md-ellipsis">
      
        raise_error_objectory_missing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.iterator" class="md-nav__link">
    <span class="md-ellipsis">
      
        iterator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iterator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.iterator.get_named_modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_named_modules
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        loss
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.loss.is_loss_decreasing" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_loss_decreasing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.loss.is_loss_decreasing_with_adam" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_loss_decreasing_with_adam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.loss.is_loss_decreasing_with_sgd" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_loss_decreasing_with_sgd
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        mode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.mode.module_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        module_mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.mode.top_module_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        top_module_mode
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.params" class="md-nav__link">
    <span class="md-ellipsis">
      
        params
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.freeze_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        freeze_module
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.has_learnable_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        has_learnable_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.has_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        has_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.num_learnable_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_learnable_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.params.unfreeze_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        unfreeze_module
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.random" class="md-nav__link">
    <span class="md-ellipsis">
      
        random
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="random">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.random.get_random_seed" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_random_seed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.random.get_torch_generator" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_torch_generator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.random.setup_torch_generator" class="md-nav__link">
    <span class="md-ellipsis">
      
        setup_torch_generator
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sonnix.utils.state_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        state_dict
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="state_dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.state_dict.find_module_state_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_module_state_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonnix.utils.state_dict.load_state_dict_to_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_state_dict_to_module
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="sonnixutils">sonnix.utils<a class="headerlink" href="#sonnixutils" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.device" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.device</span>


<a href="#sonnix.utils.device" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain utility functions to manage the device(s) of a
<code>torch.nn.Module</code>.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.device.get_module_device" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.device.get_module_device</span>


<a href="#sonnix.utils.device.get_module_device" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_module_device</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.device">device</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the device used by this module.</p>
<p>This function assumes the module uses a single device. If the
module uses several devices, you should use
<code>get_module_devices</code>. It returns <code>torch.device('cpu')</code> if
the model does not have parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.device">device</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_module_device</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_module_device</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">device(type=&#39;cpu&#39;)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.device.get_module_devices" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.device.get_module_devices</span>


<a href="#sonnix.utils.device.get_module_devices" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_module_devices</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="torch.device">device</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the devices used in a module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="torch.device">device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of <code>torch.device</code>s used in the module.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_module_devices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_module_devices</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">[device(type=&#39;cpu&#39;)]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.device.is_module_on_device" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.device.is_module_on_device</span>


<a href="#sonnix.utils.device.is_module_on_device" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_module_on_device</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n"><span title="torch.device">device</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Indicate if all the parameters of a module are on the specified
device.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="torch.device">device</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if all the parameters of the module are on the
specified device, otherwise <code>False</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_module_on_device</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_module_on_device</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.imports" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.imports</span>


<a href="#sonnix.utils.imports" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Implement some utility functions to manage optional dependencies.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.imports.check_objectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.imports.check_objectory</span>


<a href="#sonnix.utils.imports.check_objectory" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_objectory</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the <code>objectory</code> package is installed.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the <code>objectory</code> package is not installed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.imports</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_objectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_objectory</span><span class="p">()</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.imports.is_objectory_available" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.imports.is_objectory_available</span>


<a href="#sonnix.utils.imports.is_objectory_available" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_objectory_available</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Indicate if the <code>objectory</code> package is installed or not.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if <code>objectory</code> is available otherwise <code>False</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.imports</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_objectory_available</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_objectory_available</span><span class="p">()</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.imports.objectory_available" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.imports.objectory_available</span>


<a href="#sonnix.utils.imports.objectory_available" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">objectory_available</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Implement a decorator to execute a function only if <code>objectory</code>
package is installed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fn</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the function to execute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A wrapper around <code>fn</code> if <code>objectory</code> package is installed,
otherwise <code>None</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.imports</span><span class="w"> </span><span class="kn">import</span> <span class="n">objectory_available</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@objectory_available</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">my_function</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">42</span> <span class="o">+</span> <span class="n">n</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_function</span><span class="p">()</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.imports.raise_error_objectory_missing" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.imports.raise_error_objectory_missing</span>


<a href="#sonnix.utils.imports.raise_error_objectory_missing" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">raise_error_objectory_missing</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.NoReturn">NoReturn</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Raise a RuntimeError to indicate the <code>objectory</code> package is
missing.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.iterator" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.iterator</span>


<a href="#sonnix.utils.iterator" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain iterators on <code>torch.nn.Module</code>.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.iterator.get_named_modules" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.iterator.get_named_modules</span>


<a href="#sonnix.utils.iterator.get_named_modules" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_named_modules</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="collections.abc.Generator">Generator</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return an iterator over the modules, yielding both the name of
the module as well as the module itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>depth</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum depth of module to yield.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Generator">Generator</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="torch.nn.Module">Module</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The iterator over the modules and their names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.iterator</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_named_modules</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">named_modules</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">get_named_modules</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">named_modules</span>
<span class="go">[(&#39;[root]&#39;, Linear(in_features=4, out_features=6, bias=True))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">named_modules</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">get_named_modules</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">named_modules</span>
<span class="go">[(&#39;[root]&#39;, Sequential(</span>
<span class="go">  (0): Linear(in_features=4, out_features=6, bias=True)</span>
<span class="go">  (1): ReLU()</span>
<span class="go">  (2): Linear(in_features=6, out_features=3, bias=True)</span>
<span class="go">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">named_modules</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">get_named_modules</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">named_modules</span>
<span class="go">[(&#39;[root]&#39;, Sequential(</span>
<span class="go">  (0): Linear(in_features=4, out_features=6, bias=True)</span>
<span class="go">  (1): ReLU()</span>
<span class="go">  (2): Linear(in_features=6, out_features=3, bias=True)</span>
<span class="go">)),</span>
<span class="go">(&#39;0&#39;, Linear(in_features=4, out_features=6, bias=True)),</span>
<span class="go">(&#39;1&#39;, ReLU()), (&#39;2&#39;, Linear(in_features=6, out_features=3, bias=True))]</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.loss" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.loss</span>


<a href="#sonnix.utils.loss" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain utility functions to check if the loss is decreasing.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.loss.is_loss_decreasing" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.loss.is_loss_decreasing</span>


<a href="#sonnix.utils.loss.is_loss_decreasing" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_loss_decreasing</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">,</span>
    <span class="n">criterion</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">],</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">],</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="torch.optim.Optimizer">Optimizer</span></span><span class="p">,</span>
    <span class="n">feature</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">num_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10772155803920552556</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the loss decreased after some iterations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to test. The module must have a single
input tensor and a single output tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>criterion</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span> | <span title="collections.abc.Callable">Callable</span>[[<span title="torch.Tensor">Tensor</span>, <span title="torch.Tensor">Tensor</span>], <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The criterion to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="torch.optim.Optimizer">Optimizer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to update the weights of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input of the module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target used to compute the loss.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of optimization steps.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random seed to make the function
deterministic if the module contains randomness.</p>
              </div>
            </td>
            <td>
                  <code>10772155803920552556</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the loss decreased after some iterations,
otherwise <code>False</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.loss</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_loss_decreasing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_loss_decreasing</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">criterion</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">optimizer</span><span class="o">=</span><span class="n">SGD</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">feature</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">target</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.loss.is_loss_decreasing_with_adam" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.loss.is_loss_decreasing_with_adam</span>


<a href="#sonnix.utils.loss.is_loss_decreasing_with_adam" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_loss_decreasing_with_adam</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">,</span>
    <span class="n">criterion</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">],</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">],</span>
    <span class="n">feature</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">lr</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0003</span><span class="p">,</span>
    <span class="n">num_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10772155803920552556</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the loss decreased after some iterations.</p>
<p>The module is trained with the Adam optimizer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to test. The module must have a single
input tensor and a single output tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>criterion</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span> | <span title="collections.abc.Callable">Callable</span>[[<span title="torch.Tensor">Tensor</span>, <span title="torch.Tensor">Tensor</span>], <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The criterion to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input of the module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target used to compute the loss.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lr</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate.</p>
              </div>
            </td>
            <td>
                  <code>0.0003</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of optimization steps.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random seed to make the function
deterministic if the module contains randomness.</p>
              </div>
            </td>
            <td>
                  <code>10772155803920552556</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the loss decreased after some iterations,
otherwise <code>False</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.loss</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_loss_decreasing_with_adam</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_loss_decreasing_with_adam</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">module</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">criterion</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">feature</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">target</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">lr</span><span class="o">=</span><span class="mf">0.0003</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.loss.is_loss_decreasing_with_sgd" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.loss.is_loss_decreasing_with_sgd</span>


<a href="#sonnix.utils.loss.is_loss_decreasing_with_sgd" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_loss_decreasing_with_sgd</span><span class="p">(</span>
    <span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">,</span>
    <span class="n">criterion</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span> <span class="o">|</span> <span class="n"><span title="collections.abc.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">],</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">],</span>
    <span class="n">feature</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n"><span title="torch.Tensor">Tensor</span></span><span class="p">,</span>
    <span class="n">lr</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">num_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10772155803920552556</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the loss decreased after some iterations.</p>
<p>The module is trained with the <code>torch.optim.SGD</code> optimizer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to test. The module must have a single
input tensor and a single output tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>criterion</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span> | <span title="collections.abc.Callable">Callable</span>[[<span title="torch.Tensor">Tensor</span>, <span title="torch.Tensor">Tensor</span>], <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The criterion to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input of the module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target used to compute the loss.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of optimization steps.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lr</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random seed to make the function
deterministic if the module contains randomness.</p>
              </div>
            </td>
            <td>
                  <code>10772155803920552556</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the loss decreased after some iterations,
otherwise <code>False</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.loss</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_loss_decreasing_with_adam</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_loss_decreasing_with_adam</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">module</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">criterion</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">feature</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">target</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.mode</span>


<a href="#sonnix.utils.mode" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain utility functions to manage the mode of a
<code>torch.nn.Module</code>.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.mode.module_mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.mode.module_mode</span>


<a href="#sonnix.utils.mode.module_mode" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">module_mode</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="collections.abc.Generator">Generator</span></span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Implement a context manager that restores the mode (train or
eval) of every submodule individually.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to restore the mode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.mode</span><span class="w"> </span><span class="kn">import</span> <span class="n">module_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ModuleDict</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;module1&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s2">&quot;module2&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="p">[</span><span class="s2">&quot;module1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">training</span><span class="p">,</span> <span class="n">module</span><span class="p">[</span><span class="s2">&quot;module2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>
<span class="go">True False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">module_mode</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">module</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="p">[</span><span class="s2">&quot;module1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">training</span><span class="p">,</span> <span class="n">module</span><span class="p">[</span><span class="s2">&quot;module2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">ModuleDict(</span>
<span class="go">  (module1): Linear(in_features=4, out_features=6, bias=True)</span>
<span class="go">  (module2): Linear(in_features=2, out_features=4, bias=True)</span>
<span class="go">)</span>
<span class="go">False False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="p">[</span><span class="s2">&quot;module1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">training</span><span class="p">,</span> <span class="n">module</span><span class="p">[</span><span class="s2">&quot;module2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>
<span class="go">True False</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.mode.top_module_mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.mode.top_module_mode</span>


<a href="#sonnix.utils.mode.top_module_mode" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">top_module_mode</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="collections.abc.Generator">Generator</span></span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Implement a context manager that restores the mode (train or
eval) of a given module.</p>
<p>This context manager only restores the mode at the top-level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to restore the mode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.mode</span><span class="w"> </span><span class="kn">import</span> <span class="n">top_module_mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">top_module_mode</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">module</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">Linear(in_features=4, out_features=6, bias=True)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.params" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.params</span>


<a href="#sonnix.utils.params" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain utility functions to analyze and manage <code>torch.nn.Module</code>
parameters.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.params.freeze_module" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.params.freeze_module</span>


<a href="#sonnix.utils.params.freeze_module" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">freeze_module</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Freeze the parameters of the given module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to freeze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.params</span><span class="w"> </span><span class="kn">import</span> <span class="n">freeze_module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freeze_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">weight False</span>
<span class="go">bias False</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.params.has_learnable_parameters" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.params.has_learnable_parameters</span>


<a href="#sonnix.utils.params.has_learnable_parameters" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">has_learnable_parameters</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Indicate if the module has learnable parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the module has at least one learnable parameter,
<code>False</code> otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.params</span><span class="w"> </span><span class="kn">import</span> <span class="n">has_learnable_parameters</span><span class="p">,</span> <span class="n">freeze_module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">has_learnable_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freeze_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">has_learnable_parameters</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">has_learnable_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">())</span>
<span class="go">False</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.params.has_parameters" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.params.has_parameters</span>


<a href="#sonnix.utils.params.has_parameters" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">has_parameters</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="bool">bool</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Indicate if the module has parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the module has at least one parameter,
<code>False</code> otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.params</span><span class="w"> </span><span class="kn">import</span> <span class="n">has_parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">has_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">has_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">())</span>
<span class="go">False</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.params.num_learnable_parameters" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.params.num_learnable_parameters</span>


<a href="#sonnix.utils.params.num_learnable_parameters" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">num_learnable_parameters</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="int">int</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the number of learnable parameters in the module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to compute the number of learnable
parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of learnable parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.params</span><span class="w"> </span><span class="kn">import</span> <span class="n">num_learnable_parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_learnable_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freeze_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_learnable_parameters</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_learnable_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">())</span>
<span class="go">0</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.params.num_parameters" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.params.num_parameters</span>


<a href="#sonnix.utils.params.num_parameters" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">num_parameters</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="int">int</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the number of parameters in the module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to compute the number of parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.params</span><span class="w"> </span><span class="kn">import</span> <span class="n">num_parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_parameters</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">())</span>
<span class="go">0</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.params.unfreeze_module" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.params.unfreeze_module</span>


<a href="#sonnix.utils.params.unfreeze_module" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">unfreeze_module</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Unfreeze the parameters of the given module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to unfreeze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.params</span><span class="w"> </span><span class="kn">import</span> <span class="n">unfreeze_module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unfreeze_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">weight True</span>
<span class="go">bias True</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.random" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.random</span>


<a href="#sonnix.utils.random" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain utility functions to manage randomness.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.random.get_random_seed" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.random.get_random_seed</span>


<a href="#sonnix.utils.random.get_random_seed" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_random_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="int">int</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a random seed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random seed to make the process
reproducible.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random seed. The value is between <code>-2 ** 63</code> and
<code>2 ** 63 - 1</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_random_seed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_random_seed</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="go">6176747449835261347</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.random.get_torch_generator" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.random.get_torch_generator</span>


<a href="#sonnix.utils.random.get_torch_generator" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_torch_generator</span><span class="p">(</span>
    <span class="n">random_seed</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="n"><span title="torch.device">device</span></span> <span class="o">|</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Generator">Generator</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a <code>torch.Generator</code> initialized with a given seed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>random_seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random seed.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="torch.device">device</span> | <span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired device for the generator.</p>
              </div>
            </td>
            <td>
                  <code>&#39;cpu&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Generator">Generator</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>torch.Generator</code> object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_torch_generator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">get_torch_generator</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="n">generator</span><span class="p">)</span>
<span class="go">tensor([[0.8823, 0.9150, 0.3829, 0.9593],</span>
<span class="go">        [0.3904, 0.6009, 0.2566, 0.7936]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">get_torch_generator</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="n">generator</span><span class="p">)</span>
<span class="go">tensor([[0.8823, 0.9150, 0.3829, 0.9593],</span>
<span class="go">        [0.3904, 0.6009, 0.2566, 0.7936]])</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.random.setup_torch_generator" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.random.setup_torch_generator</span>


<a href="#sonnix.utils.random.setup_torch_generator" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">setup_torch_generator</span><span class="p">(</span>
    <span class="n">generator_or_seed</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="torch.Generator">Generator</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="torch.Generator">Generator</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set up a <code>torch.Generator</code> object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>generator_or_seed</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="torch.Generator">Generator</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>torch.Generator</code> object or
a random seed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Generator">Generator</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>torch.Generator</code> object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">setup_torch_generator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">setup_torch_generator</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span>
<span class="go">&lt;torch._C.Generator object at 0x...&gt;</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="sonnix.utils.state_dict" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">sonnix.utils.state_dict</span>


<a href="#sonnix.utils.state_dict" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Contain utility functions to manipulate <code>torch.nn.Module</code>'s state
dict.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.state_dict.find_module_state_dict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.state_dict.find_module_state_dict</span>


<a href="#sonnix.utils.state_dict.find_module_state_dict" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_module_state_dict</span><span class="p">(</span>
    <span class="n">state_dict</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span> <span class="o">|</span> <span class="n"><span title="list">list</span></span> <span class="o">|</span> <span class="n"><span title="tuple">tuple</span></span> <span class="o">|</span> <span class="n"><span title="set">set</span></span><span class="p">,</span> <span class="n">module_keys</span><span class="p">:</span> <span class="n"><span title="set">set</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Try to find automatically the part of the state dict related to a
module.</p>
<p>The user should specify the set of module's keys:
<code>set(module.state_dict().keys())</code>. This function assumes that
the set of keys only exists at one location in the state dict.
If the set of keys exists at several locations in the state dict,
only the first one is returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | <span title="list">list</span> | <span title="tuple">tuple</span> | <span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state dict. This function is called recursively
on this input to find the queried state dict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>module_keys</code>
            </td>
            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The set of module keys.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The part of the state dict related to a module if it is
found, otherwise an empty dict.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_module_state_dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;network&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>            <span class="s2">&quot;bias&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span> <span class="o">=</span> <span class="n">find_module_state_dict</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">module_keys</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state_dict</span>
<span class="go">{&#39;weight&#39;: tensor([[1., 1., 1., 1.],</span>
<span class="go">        [1., 1., 1., 1.],</span>
<span class="go">        [1., 1., 1., 1.],</span>
<span class="go">        [1., 1., 1., 1.],</span>
<span class="go">        [1., 1., 1., 1.]]), &#39;bias&#39;: tensor([2., 2., 2., 2., 2.])}</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="sonnix.utils.state_dict.load_state_dict_to_module" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sonnix.utils.state_dict.load_state_dict_to_module</span>


<a href="#sonnix.utils.state_dict.load_state_dict_to_module" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_state_dict_to_module</span><span class="p">(</span>
    <span class="n">state_dict</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n"><span title="torch.nn.Module">Module</span></span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a state dict into a given module.</p>
<p>This function will automatically try to find the module state dict
in the given state dict.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state dict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module. This function changes the weights of this
module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to strictly enforce that the
keys in <code>state_dict</code> match the keys returned by this
module's <code>torch.nn.Module.state_dict</code> function.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sonnix.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_state_dict_to_module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;network&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>            <span class="s2">&quot;bias&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_state_dict_to_module</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">module</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span>
<span class="go">tensor([[6., 6., 6., 6., 6.],</span>
<span class="go">        [6., 6., 6., 6., 6.]], grad_fn=&lt;AddmmBackward0&gt;)</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - present Thibaut Durand
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.expand", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"method": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>